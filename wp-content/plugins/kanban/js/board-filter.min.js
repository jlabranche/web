function board_filter_store(r,e){board.filters[r]={hash:"filter_"+r+"="+e+"&",id:e}}!function($){$.fn.board_filter=function(r){return this.each(function(){var r=$(this),e=new t($("#t-filter-project").html()),o=new t($("#t-filter-user").html()),i=$("#filter-project_id-dropdown",r),a=$("#filter-user_id_assigned-dropdown",r);$(".filter",r).on("populate_dropdown","a",function(r,e){var t=$(this),o=t.closest(".dropup"),i=$(".btn-label",o);"undefined"==typeof e&&(e=t.text()),"undefined"==typeof i.attr("data-orig")&&i.attr("data-orig",i.text()),i.text(e)}),$("#filter-project_id",r).on("show.bs.dropdown",function(){$(".project",i).remove();for(var r in board.project_records){var t=$(e.render(board.project_records[r]));t.prependTo(i)}}),i.on("click","a",function(){var e=$(this),t=e.attr("data-id");if("undefined"!=typeof board.project_records[t])var o=board.project_records[t],i=o.title;return e.trigger("populate_dropdown",[i]),board_filter_store("project_id",t),$("#btn-filter-apply",r).trigger("click"),!1}),$("#filter-user_id_assigned",r).on("show.bs.dropdown",function(){$(".user",a).remove();for(var r in board.allowed_users()){var e=board.allowed_users()[r];if(user_has_cap("write",e)){var t=$(o.render(e));t.prependTo(a)}}}),a.on("click","a",function(){var e=$(this),t=e.attr("data-id");if("undefined"!=typeof board.allowed_users()[t])var o=board.allowed_users()[t],i=o.long_name_email;return e.trigger("populate_dropdown",[i]),board_filter_store("user_id_assigned",t),$("#btn-filter-apply",r).trigger("click"),!1}),$("#btn-filter-apply",r).on("click",function(){$("#btn-filter-reset").show();var r="",e="#";for(var t in board.filters)if("undefined"!=typeof board.filters[t].id){"undefined"!=typeof board.filters[t].hash&&(e+=board.filters[t].hash);var o=board.filters[t].id;for(var i in board.task_records){var a=board.task_records[i];a[t]!=o&&(r+="#task-"+i+",")}}r=r.replace(/(^,)|(,$)/g,"");var d=$(r);location.hash=e,d.slideUp("fast"),$(".task").not(d).slideDown("fast")}),$("#btn-filter-reset",r).on("click",function(){$(this).hide(),$(".task:not(:visible)").slideDown("fast"),$("#filter-wrapper .btn-label").each(function(){var r=$(this);r.text(r.attr("data-orig"))});for(var r in board.filters)board.filters[r]={};location.hash="#"})})}}(jQuery);