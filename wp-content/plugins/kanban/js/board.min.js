jQuery(function($){$("#filter-wrapper").board_filter(),$("#search-wrapper").board_search(),$("#btn-group-view-compact").board_view(),$("#modal-projects").modal_projects(),$("#btn-empty-status-tasks").on("click",function(){$("#empty-archive-confirmation-label").text("Deleting...");var t=$(this).prop("disabled",!0),e=t.attr("data-status-col-id");timers.delete_task_interval=setInterval(function(){var t=$("#{0} .task:first .delete-task".sprintf(e));0==t.length?(clearInterval(timers.delete_task_interval),$("#btn-empty-status-tasks").prop("disabled",!1),$("#modal-empty-archive").modal("hide")):t.click()},3e3)}),$("#btn-empty-status-tasks-cancel").on("click",function(){clearInterval(timers.delete_task_interval)}),$(document).mousedown(function(t){$last_clicked=$(t.target)});var t=records_by_position(board.status_records()),e=0;for(var s in t){var a=t[s];0==e&&(a.left_open=0,a.left_close="-{0}".sprintf(sidebar_w)),e==Object.size(t)-1&&(a.left_open="-{0}".sprintf(2*sidebar_w),a.left_close="-{0}".sprintf(sidebar_w));var r=$(t_col_status.render({status:a,current_user_can_write:current_user_has_cap("write")}));r.appendTo("#row-statuses").board_sidebar_header();var r=$(t_col_tasks.render({status:a,current_user_can_write:current_user_has_cap("write")}));r.appendTo("#row-tasks"),e++}for(var s in board.task_records){var o=board.task_records[s];add_task_to_status_col(o)}$(document).trigger("/tasks/added/",o),current_user_has_cap("write")&&$(".col-tasks").sortable({connectWith:".col-tasks",handle:".task-handle",forcePlaceholderSize:!0,forceHelperSize:!0,placeholder:"task-placeholder",over:function(t,e){e.placeholder.closest(".col-tasks").addClass("hover")},out:function(t,e){e.placeholder.closest(".col-tasks").removeClass("hover")},stop:function(t,e){$(".col-tasks.hover").removeClass("hover")},receive:function(t,e){var s=e.item.attr("data-id"),a=e.item.closest(".col-tasks"),r=a.attr("data-status-id");e.item.trigger("status_change",[r]),$(".col-tasks").matchHeight()}}),$("body").on("keydown",function(t){var e=$("input:focus, textarea:focus, [contenteditable]:focus");return 37===t.keyCode&&0===e.length&&t.shiftKey&&($(".col-status:last").hasClass("is-open")?$(".col-status:last").trigger("close"):$(".col-status:first").hasClass("is-open")||$(".col-status:first").trigger("open")),39===t.keyCode&&0===e.length&&t.shiftKey&&($(".col-status:first").hasClass("is-open")?$(".col-status:first").trigger("close"):$(".col-status:last").hasClass("is-open")||$(".col-status:last").trigger("open")),9===t.keyCode&&0===e.length?($("#btn-group-view-compact .btn:has(input:not(:checked))").trigger("click"),!1):83===t.keyCode&&0===e.length?($("#board-search").focus(),!1):void 0});var i=Cookies.get("kanban-board-view");(1==board.settings().default_to_compact_view||"compact"==i)&&$('#btn-group-view-compact .btn:has([name="view-compact"])').trigger("click");var c=[];if(location.hash){var n=location.hash.substr(1).split("&");for(var e in n){var l=n[e].split("=");"undefined"!=typeof l[1]&&(c[l[0]]=l[1])}}var d=!1;for(var u in c)if(0===u.indexOf("filter_")){var s=c[u],p=u.substring("filter_".length);board_filter_store(p,s);var _=$("#filter-{0}".sprintf(p));_.trigger("show.bs.dropdown");var f=$("[data-id={1}]".sprintf(p,s),_);f.trigger("populate_dropdown",[f.text()]),d=!0}d&&$("#btn-filter-apply").trigger("click"),current_user_has_cap("write")&&$(".col-tasks").on("mouseenter",function(){var t=$(this).attr("data-status-id");$("#status-{0}".sprintf(t)).addClass("hover")}).on("mouseleave",function(){var t=$(this).attr("data-status-id");$("#status-{0}".sprintf(t)).removeClass("hover")}),$(window).load(function(){$(".col-tasks").matchHeight()}),$(window).resize(function(){$(".col-tasks").matchHeight()}),""!==alert&&$.bootstrapGrowl(alert,{type:"info",allow_dismiss:!0})});